PheWAS_sums <- get_signal_PheWAS(credible_set = discordant_snps_credible_set_99,
BF_Weighted_PheWAS = discordant_loci_PheWAS_BF_weighted_effect)
get_signal_PheWAS <- function(credible_set, BF_Weighted_PheWAS)
{
Coordinates <- unique(credible_set$COORDINATES)
iteration = 1
signal_PheWAS <- BF_Weighted_PheWAS[1,]
signal_PheWAS[1,] <- NA
column_names <- colnames(signal_PheWAS)
column_names[1] = 'SIGNAL'
colnames(signal_PheWAS) <- column_names
Highest_BF_SNP <- c(NA)
for (Coordinate in Coordinates) {
Coordinate_credible_set <- subset(credible_set, COORDINATES == Coordinate)
BF_sum <- sum(Coordinate_credible_set$BF)
BF_SNP <- Coordinate_credible_set[which.max(Coordinate_credible_set$BF),]
Highest_BF_SNP <- c(Highest_BF_SNP,BF_SNP$SNP)
Coordinate_PheWAS <- subset(BF_Weighted_PheWAS, rsID %in% Coordinate_credible_set$SNP)
Coordinate_PheWAS <- Coordinate_PheWAS[2:9]
PheWAS_Z_sum <- colSums(Coordinate_PheWAS)/BF_sum
Coordinate_PheWAS <- c(Coordinate,PheWAS_Z_sum)
signal_PheWAS <- rbind(signal_PheWAS, Coordinate_PheWAS)
iteration = iteration + 1
}
signal_PheWAS$SNP <- Highest_BF_SNP
return(na.omit(signal_PheWAS))
}
PheWAS_sums <- get_signal_PheWAS(credible_set = discordant_snps_credible_set_99,
BF_Weighted_PheWAS = discordant_loci_PheWAS_BF_weighted_effect)
PheWAS_sums <- get_signal_PheWAS(credible_set = discordant_snps_credible_set_99,
BF_Weighted_PheWAS = discordant_loci_PheWAS_BF_weighted_effect)
heatmap_PheWAS <- PheWAS_sums
row.names(heatmap_PheWAS) <- heatmap_PheWAS$SNP
heatmap_PheWAS$SIGNAL <- NULL
heatmap_PheWAS$SNP <- NULL
heatmap_PheWAS <- as.matrix(heatmap_PheWAS)
heatmap_PheWAS <- matrix(as.numeric(heatmap_PheWAS),
ncol = length(colnames(heatmap_PheWAS)))
rownames(heatmap_PheWAS) <- PheWAS_sums$SNP
colnames(heatmap_PheWAS) <- colnames(PheWAS_sums)[2:8]
colnames(heatmap_PheWAS) <- colnames(PheWAS_sums)[2:9]
pheatmap(heatmap_PheWAS)
library(ggplot2)
colnames(heatmap_PheWAS) <- c('HDL','TG','LDL','TC','FI','FG','TwoHrGlu','HbA1C')
pheatmap(heatmap_PheWAS)
ggsave(filename = 'PheWAS_summary_figure.jpeg', units = 'in', width = 5,
height = 5, res = 300)
ggsave(filename = 'PheWAS_summary_figure.jpeg', units = 'in', width = 5,
height = 5)
setwd('/Users/ya8eb/Documents/Research/colocalization_analysis_whradjbmi_t2dadjbmi/PheWAS/figures')
ggsave(filename = 'PheWAS_summary_figure.jpeg', units = 'in', width = 5,
height = 5)
PheWAS_sums <- get_signal_PheWAS(credible_set = discordant_snps_credible_set_99,
BF_Weighted_PheWAS = discordant_loci_PheWAS_BF_weighted_effect)
heatmap_PheWAS <- PheWAS_sums
row.names(heatmap_PheWAS) <- heatmap_PheWAS$SNP
heatmap_PheWAS$SIGNAL <- NULL
heatmap_PheWAS$SNP <- NULL
heatmap_PheWAS <- as.matrix(heatmap_PheWAS)
heatmap_PheWAS <- matrix(as.numeric(heatmap_PheWAS),
ncol = length(colnames(heatmap_PheWAS)))
rownames(heatmap_PheWAS) <- PheWAS_sums$SNP
colnames(heatmap_PheWAS) <- c('HDL','TG','LDL','TC','FI','FG','TwoHrGlu','HbA1C')
pheatmap(heatmap_PheWAS)
setwd('/Users/ya8eb/Documents/Research/colocalization_analysis_whradjbmi_t2dadjbmi/PheWAS/figures')
ggsave(filename = 'PheWAS_summary_figure.jpeg', units = 'in', width = 5,
height = 5)
PheWAS_sums <- get_signal_PheWAS(credible_set = discordant_snps_credible_set_99,
BF_Weighted_PheWAS = discordant_loci_PheWAS_BF_weighted_effect)
heatmap_PheWAS <- PheWAS_sums
row.names(heatmap_PheWAS) <- heatmap_PheWAS$SNP
heatmap_PheWAS$SIGNAL <- NULL
heatmap_PheWAS$SNP <- NULL
heatmap_PheWAS <- as.matrix(heatmap_PheWAS)
heatmap_PheWAS <- matrix(as.numeric(heatmap_PheWAS),
ncol = length(colnames(heatmap_PheWAS)))
rownames(heatmap_PheWAS) <- PheWAS_sums$SNP
colnames(heatmap_PheWAS) <- c('HDL','TG','LDL','TC','FI','FG','TwoHrGlu','HbA1C')
setwd('/Users/ya8eb/Documents/Research/colocalization_analysis_whradjbmi_t2dadjbmi/PheWAS/figures')
jpeg(filename = 'PheWAS_summary_figure.jpeg', units = 'in', width = 5,
height = 5)
pheatmap(heatmap_PheWAS)
dev.off()
PheWAS_sums <- get_signal_PheWAS(credible_set = discordant_snps_credible_set_99,
BF_Weighted_PheWAS = discordant_loci_PheWAS_BF_weighted_effect)
heatmap_PheWAS <- PheWAS_sums
row.names(heatmap_PheWAS) <- heatmap_PheWAS$SNP
heatmap_PheWAS$SIGNAL <- NULL
heatmap_PheWAS$SNP <- NULL
heatmap_PheWAS <- as.matrix(heatmap_PheWAS)
heatmap_PheWAS <- matrix(as.numeric(heatmap_PheWAS),
ncol = length(colnames(heatmap_PheWAS)))
rownames(heatmap_PheWAS) <- PheWAS_sums$SNP
colnames(heatmap_PheWAS) <- c('HDL','TG','LDL','TC','FI','FG','TwoHrGlu','HbA1C')
setwd('/Users/ya8eb/Documents/Research/colocalization_analysis_whradjbmi_t2dadjbmi/PheWAS/figures')
jpeg(filename = 'PheWAS_summary_figure.jpeg', units = 'in', width = 5,
height = 5, res = 300)
pheatmap(heatmap_PheWAS)
dev.off()
#### load libraries ------------------------------------------------
{
library(vroom)
library(TACTICAL)
library(caroline)
library(ggplot2)
library(gridExtra)
library(reshape2)
}
setwd('/Users/ya8eb/Documents/Research/colocalization_analysis_whradjbmi_t2dadjbmi/tactical_no_brain/results')
View(discordant_99_PheWAS)
View(credible_set_99)
View(discordant_loci_PheWAS_BF_weighted_effect)
View(discordant_snps_credible_set_99)
View(discordant_snps)
View(discordant_snps_credible_set_99)
View(PheWAS_sums)
setwd('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results')
# load data ----------------------------------------------------------
STARNET_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/5e-06/t2dadjbmi_coloc_summary_file.txt')
STARNET_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/5e-06/whradjbmi_coloc_summary_file.txt')
# load data ----------------------------------------------------------
STARNET_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/5e-06/t2dadjbmi_coloc_summary_file.txt')
STARNET_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/5e-06/whradjbmi_coloc_summary_file.txt')
View(STARNET_T2DadjBMI)
# load data ----------------------------------------------------------
STARNET_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/t2dadjbmi_coloc_summary_file.txt')
STARNET_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/whradjbmi_coloc_summary_file.txt')
GTEx_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/t2dadjbmi_coloc_summary_file.txt')
GTEx_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/whradjbmi_coloc_summary_file.txt')
# load data ----------------------------------------------------------
STARNET_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/t2dadjbmi_coloc_summary_file.txt')
STARNET_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/whradjbmi_coloc_summary_file.txt')
GTEx_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/t2dadjbmi_coloc_summary_file.txt')
GTEx_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/whradjbmi_coloc_summary_file.txt')
METSIM_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/eQTL/whradjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/eQTL/t2dadjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/t2dadjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/t2dadjbmi_coloc_summary_file.txt')
View(STARNET_WHRadjBMI)
STARNET_T2DadjBMI <- find_significant_colocs(STARNET_T2DadjBMI)
METSIM_WHRadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/whradjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/t2dadjbmi_coloc_summary_file.txt')
# load libraries ----------------------------------------------------------
library()
# load data ----------------------------------------------------------
STARNET_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/t2dadjbmi_coloc_summary_file.txt')
STARNET_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/whradjbmi_coloc_summary_file.txt')
GTEx_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/t2dadjbmi_coloc_summary_file.txt')
GTEx_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/whradjbmi_coloc_summary_file.txt')
METSIM_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/eQTL/whradjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/eQTL/t2dadjbmi_coloc_summary_file.txt')
METSIM_WHRadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/whradjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/t2dadjbmi_coloc_summary_file.txt')
# declare functions ----------------------------------------------------------
find_significant_colocs <- function(coloc_stats){
return(subset(coloc_stats, PPH4 > 0.50))
}
# execute analysis ----------------------------------------------------------
STARNET_T2DadjBMI <- find_significant_colocs(STARNET_T2DadjBMI)
STARNET_WHRadjBMI <- find_significant_colocs(STARNET_WHRadjBMI)
GTEx_T2DadjBMI <- find_significant_colocs(GTEx_T2DadjBMI)
GTEx_WHRadjBMI <- find_significant_colocs(GTEx_WHRadjBMI)
METSIM_WHRadjBMI <- find_significant_colocs(METSIM_WHRadjBMI)
METSIM_T2DadjBMI <- find_significant_colocs(METSIM_T2DadjBMI)
METSIM_T2DadjBMI_sQTL <- find_significant_colocs(METSIM_T2DadjBMI_sQTL)
METSIM_WHRadjBMI_sQTL <- find_significant_colocs(METSIM_WHRadjBMI_sQTL)
# load libraries ----------------------------------------------------------
library()
# load data ----------------------------------------------------------
STARNET_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/t2dadjbmi_coloc_summary_file.txt')
STARNET_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/whradjbmi_coloc_summary_file.txt')
GTEx_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/t2dadjbmi_coloc_summary_file.txt')
GTEx_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/whradjbmi_coloc_summary_file.txt')
METSIM_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/eQTL/whradjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/eQTL/t2dadjbmi_coloc_summary_file.txt')
METSIM_WHRadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/whradjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/t2dadjbmi_coloc_summary_file.txt')
# declare functions ----------------------------------------------------------
find_significant_colocs <- function(coloc_stats){
return(subset(coloc_stats, PPH4 > 0.50))
}
# execute analysis ----------------------------------------------------------
STARNET_T2DadjBMI <- find_significant_colocs(STARNET_T2DadjBMI)
STARNET_WHRadjBMI <- find_significant_colocs(STARNET_WHRadjBMI)
GTEx_T2DadjBMI <- find_significant_colocs(GTEx_T2DadjBMI)
GTEx_WHRadjBMI <- find_significant_colocs(GTEx_WHRadjBMI)
METSIM_WHRadjBMI <- find_significant_colocs(METSIM_WHRadjBMI)
METSIM_T2DadjBMI <- find_significant_colocs(METSIM_T2DadjBMI)
METSIM_T2DadjBMI_sQTL <- find_significant_colocs(METSIM_T2DadjBMI_sQTL)
METSIM_WHRadjBMI_sQTL <- find_significant_colocs(METSIM_WHRadjBMI_sQTL)
# load libraries ----------------------------------------------------------
# load data ----------------------------------------------------------
STARNET_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/t2dadjbmi_coloc_summary_file.txt')
STARNET_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/whradjbmi_coloc_summary_file.txt')
GTEx_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/t2dadjbmi_coloc_summary_file.txt')
GTEx_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/whradjbmi_coloc_summary_file.txt')
METSIM_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/eQTL/whradjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/eQTL/t2dadjbmi_coloc_summary_file.txt')
METSIM_WHRadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/whradjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/t2dadjbmi_coloc_summary_file.txt')
# declare functions ----------------------------------------------------------
find_significant_colocs <- function(coloc_stats){
return(subset(coloc_stats, PPH4 > 0.50))
}
# execute analysis ----------------------------------------------------------
STARNET_T2DadjBMI <- find_significant_colocs(STARNET_T2DadjBMI)
STARNET_WHRadjBMI <- find_significant_colocs(STARNET_WHRadjBMI)
GTEx_T2DadjBMI <- find_significant_colocs(GTEx_T2DadjBMI)
GTEx_WHRadjBMI <- find_significant_colocs(GTEx_WHRadjBMI)
METSIM_WHRadjBMI <- find_significant_colocs(METSIM_WHRadjBMI)
METSIM_T2DadjBMI <- find_significant_colocs(METSIM_T2DadjBMI)
METSIM_T2DadjBMI_sQTL <- find_significant_colocs(METSIM_T2DadjBMI_sQTL)
METSIM_WHRadjBMI_sQTL <- find_significant_colocs(METSIM_WHRadjBMI_sQTL)
View(GTEx_T2DadjBMI)
View(STARNET_T2DadjBMI)
View(GTEx_WHRadjBMI)
View(GTEx_T2DadjBMI)
View(METSIM_T2DadjBMI)
View(METSIM_T2DadjBMI_sQTL)
View(METSIM_T2DadjBMI)
View(METSIM_WHRadjBMI_sQTL)
View(GTEx_T2DadjBMI)
unique(GTEx_T2DadjBMI$Gene_ID)
unique(GTEx_WHRadjBMI$Gene_ID)
View(STARNET_T2DadjBMI)
View(STARNET_WHRadjBMI)
GTEx_WHRadjBMI$Gene_ID <- gsub('\\..*','',GTEx_WHRadjBMI$Gene_ID)
GTEx_T2DadjBMI$Gene_ID <- gsub('\\..*','',GTEx_T2DadjBMI$Gene_ID)
unique(c(GTEx_T2DadjBMI$Tissue_Name, GTEx_WHRadjBMI$Tissue_Name))
unique(c(GTEx_WHRadjBMI$Gene_ID,GTEx_T2DadjBMI$Gene_ID))
View(STARNET_T2DadjBMI)
View(STARNET_WHRadjBMI)
View(STARNET_T2DadjBMI)
# declare functions ----------------------------------------------------------
find_significant_colocs <- function(coloc_stats){
return(subset(coloc_stats, PPH4 > 0.50) & !(Gene_ID %in% genes_not_in_discordant_loci))
}
# execute analysis ----------------------------------------------------------
STARNET_T2DadjBMI <- find_significant_colocs(STARNET_T2DadjBMI)
genes_not_in_discordant_loci <- c('ENSG00000126861','ENSG00000126860','ENSG00000196712','EVI2A')
# declare functions ----------------------------------------------------------
find_significant_colocs <- function(coloc_stats){
return(subset(coloc_stats, PPH4 > 0.50) & !(Gene_ID %in% genes_not_in_discordant_loci))
}
# execute analysis ----------------------------------------------------------
genes_not_in_discordant_loci <- c('ENSG00000126861','ENSG00000126860','ENSG00000196712','EVI2A')
STARNET_T2DadjBMI <- find_significant_colocs(STARNET_T2DadjBMI)
View(STARNET_T2DadjBMI)
View(STARNET_WHRadjBMI)
# declare functions ----------------------------------------------------------
find_significant_colocs <- function(coloc_stats){
return(subset(coloc_stats, PPH4 > 0.50& !(Gene_ID %in% genes_not_in_discordant_loci)))
}
# execute analysis ----------------------------------------------------------
genes_not_in_discordant_loci <- c('ENSG00000126861','ENSG00000126860','ENSG00000196712','EVI2A')
STARNET_T2DadjBMI <- find_significant_colocs(STARNET_T2DadjBMI)
STARNET_WHRadjBMI <- find_significant_colocs(STARNET_WHRadjBMI)
GTEx_T2DadjBMI <- find_significant_colocs(GTEx_T2DadjBMI)
GTEx_WHRadjBMI <- find_significant_colocs(GTEx_WHRadjBMI)
METSIM_WHRadjBMI <- find_significant_colocs(METSIM_WHRadjBMI)
METSIM_T2DadjBMI <- find_significant_colocs(METSIM_T2DadjBMI)
METSIM_T2DadjBMI_sQTL <- find_significant_colocs(METSIM_T2DadjBMI_sQTL)
View(METSIM_T2DadjBMI_sQTL)
View(METSIM_WHRadjBMI)
# declare functions ----------------------------------------------------------
find_significant_colocs <- function(coloc_stats){
return(subset(coloc_stats, PPH4 > 0.50 & !(Gene_ID %in% genes_not_in_discordant_loci)))
}
# execute analysis ----------------------------------------------------------
genes_not_in_discordant_loci <- c('ENSG00000126861','ENSG00000126860','ENSG00000196712','EVI2A','NF1')
STARNET_T2DadjBMI <- find_significant_colocs(STARNET_T2DadjBMI)
STARNET_WHRadjBMI <- find_significant_colocs(STARNET_WHRadjBMI)
GTEx_T2DadjBMI <- find_significant_colocs(GTEx_T2DadjBMI)
GTEx_WHRadjBMI <- find_significant_colocs(GTEx_WHRadjBMI)
METSIM_WHRadjBMI <- find_significant_colocs(METSIM_WHRadjBMI)
METSIM_T2DadjBMI <- find_significant_colocs(METSIM_T2DadjBMI)
View(GTEx_WHRadjBMI)
# load libraries ----------------------------------------------------------
# load data ----------------------------------------------------------
STARNET_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/t2dadjbmi_coloc_summary_file.txt')
STARNET_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/whradjbmi_coloc_summary_file.txt')
GTEx_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/t2dadjbmi_coloc_summary_file.txt')
GTEx_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/whradjbmi_coloc_summary_file.txt')
METSIM_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/eQTL/whradjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/eQTL/t2dadjbmi_coloc_summary_file.txt')
METSIM_WHRadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/whradjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/t2dadjbmi_coloc_summary_file.txt')
# declare functions ----------------------------------------------------------
find_significant_colocs <- function(coloc_stats){
return(subset(coloc_stats, PPH4 > 0.50 & !(Gene_ID %in% genes_not_in_discordant_loci)))
}
# execute analysis ----------------------------------------------------------
genes_not_in_discordant_loci <- c('ENSG00000126861','ENSG00000126860','ENSG00000196712','EVI2A','NF1')
STARNET_T2DadjBMI <- find_significant_colocs(STARNET_T2DadjBMI)
STARNET_WHRadjBMI <- find_significant_colocs(STARNET_WHRadjBMI)
GTEx_T2DadjBMI <- find_significant_colocs(GTEx_T2DadjBMI)
GTEx_WHRadjBMI <- find_significant_colocs(GTEx_WHRadjBMI)
METSIM_WHRadjBMI <- find_significant_colocs(METSIM_WHRadjBMI)
METSIM_T2DadjBMI <- find_significant_colocs(METSIM_T2DadjBMI)
# load libraries ----------------------------------------------------------
# load data ----------------------------------------------------------
STARNET_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/t2dadjbmi_coloc_summary_file.txt')
STARNET_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/whradjbmi_coloc_summary_file.txt')
GTEx_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/t2dadjbmi_coloc_summary_file.txt')
GTEx_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/whradjbmi_coloc_summary_file.txt')
METSIM_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/eQTL/whradjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/eQTL/t2dadjbmi_coloc_summary_file.txt')
METSIM_WHRadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/whradjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/t2dadjbmi_coloc_summary_file.txt')
# declare functions ----------------------------------------------------------
find_significant_colocs <- function(coloc_stats){
coloc_stats <- subset(coloc_stats, PPH4 > 0.50)
column_names <- colnames(coloc_stats)
if ('Gene_ID' %in% column_names) {
coloc_stats <- subset(coloc_stats, !(Gene_ID %in% genes_not_in_discordant_loci))
}
}
genes_not_in_discordant_loci <- c('ENSG00000126861','ENSG00000126860','ENSG00000196712','EVI2A','NF1')
STARNET_T2DadjBMI <- find_significant_colocs(STARNET_T2DadjBMI)
STARNET_WHRadjBMI <- find_significant_colocs(STARNET_WHRadjBMI)
GTEx_T2DadjBMI <- find_significant_colocs(GTEx_T2DadjBMI)
GTEx_WHRadjBMI <- find_significant_colocs(GTEx_WHRadjBMI)
METSIM_WHRadjBMI <- find_significant_colocs(METSIM_WHRadjBMI)
METSIM_T2DadjBMI <- find_significant_colocs(METSIM_T2DadjBMI)
METSIM_T2DadjBMI_sQTL <- find_significant_colocs(METSIM_T2DadjBMI_sQTL)
METSIM_WHRadjBMI_sQTL <- find_significant_colocs(METSIM_WHRadjBMI_sQTL)
# load libraries ----------------------------------------------------------
# load data ----------------------------------------------------------
STARNET_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/t2dadjbmi_coloc_summary_file.txt')
STARNET_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/whradjbmi_coloc_summary_file.txt')
GTEx_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/t2dadjbmi_coloc_summary_file.txt')
GTEx_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/whradjbmi_coloc_summary_file.txt')
METSIM_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/eQTL/whradjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/eQTL/t2dadjbmi_coloc_summary_file.txt')
METSIM_WHRadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/whradjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/t2dadjbmi_coloc_summary_file.txt')
GTEx_WHRadjBMI$Gene_ID <- gsub('\\..*','',GTEx_WHRadjBMI$Gene_ID)
GTEx_T2DadjBMI$Gene_ID <- gsub('\\..*','',GTEx_T2DadjBMI$Gene_ID)
# declare functions ----------------------------------------------------------
find_significant_colocs <- function(coloc_stats){
coloc_stats <- subset(coloc_stats, PPH4 > 0.50)
column_names <- colnames(coloc_stats)
if ('Gene_ID' %in% column_names) {
coloc_stats <- subset(coloc_stats, !(Gene_ID %in% genes_not_in_discordant_loci))
}
}
# execute analysis ----------------------------------------------------------
genes_not_in_discordant_loci <- c('ENSG00000126861','ENSG00000126860','ENSG00000196712','EVI2A','NF1')
STARNET_T2DadjBMI <- find_significant_colocs(STARNET_T2DadjBMI)
STARNET_WHRadjBMI <- find_significant_colocs(STARNET_WHRadjBMI)
GTEx_T2DadjBMI <- find_significant_colocs(GTEx_T2DadjBMI)
GTEx_WHRadjBMI <- find_significant_colocs(GTEx_WHRadjBMI)
METSIM_WHRadjBMI <- find_significant_colocs(METSIM_WHRadjBMI)
METSIM_T2DadjBMI <- find_significant_colocs(METSIM_T2DadjBMI)
METSIM_T2DadjBMI_sQTL <- find_significant_colocs(METSIM_T2DadjBMI_sQTL)
METSIM_WHRadjBMI_sQTL <- find_significant_colocs(METSIM_WHRadjBMI_sQTL)
# load libraries ----------------------------------------------------------
# load data ----------------------------------------------------------
STARNET_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/t2dadjbmi_coloc_summary_file.txt')
STARNET_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/whradjbmi_coloc_summary_file.txt')
GTEx_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/t2dadjbmi_coloc_summary_file.txt')
GTEx_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/whradjbmi_coloc_summary_file.txt')
METSIM_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/eQTL/whradjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/eQTL/t2dadjbmi_coloc_summary_file.txt')
METSIM_WHRadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/whradjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/t2dadjbmi_coloc_summary_file.txt')
GTEx_WHRadjBMI$Gene_ID <- gsub('\\..*','',GTEx_WHRadjBMI$Gene_ID)
GTEx_T2DadjBMI$Gene_ID <- gsub('\\..*','',GTEx_T2DadjBMI$Gene_ID)
# declare functions ----------------------------------------------------------
find_significant_colocs <- function(coloc_stats){
coloc_stats <- subset(coloc_stats, PPH4 > 0.50)
column_names <- colnames(coloc_stats)
if ('Gene_ID' %in% column_names) {
coloc_stats <- subset(coloc_stats, !(Gene_ID %in% genes_not_in_discordant_loci))
}
return(coloc_stats)
}
# execute analysis ----------------------------------------------------------
genes_not_in_discordant_loci <- c('ENSG00000126861','ENSG00000126860','ENSG00000196712','EVI2A','NF1')
STARNET_T2DadjBMI <- find_significant_colocs(STARNET_T2DadjBMI)
STARNET_WHRadjBMI <- find_significant_colocs(STARNET_WHRadjBMI)
GTEx_T2DadjBMI <- find_significant_colocs(GTEx_T2DadjBMI)
GTEx_WHRadjBMI <- find_significant_colocs(GTEx_WHRadjBMI)
METSIM_WHRadjBMI <- find_significant_colocs(METSIM_WHRadjBMI)
METSIM_T2DadjBMI <- find_significant_colocs(METSIM_T2DadjBMI)
METSIM_T2DadjBMI_sQTL <- find_significant_colocs(METSIM_T2DadjBMI_sQTL)
METSIM_WHRadjBMI_sQTL <- find_significant_colocs(METSIM_WHRadjBMI_sQTL)
# load libraries ----------------------------------------------------------
# load data ----------------------------------------------------------
STARNET_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/t2dadjbmi_coloc_summary_file.txt')
STARNET_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/whradjbmi_coloc_summary_file.txt')
GTEx_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/t2dadjbmi_coloc_summary_file.txt')
GTEx_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/whradjbmi_coloc_summary_file.txt')
METSIM_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/eQTL/whradjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/eQTL/t2dadjbmi_coloc_summary_file.txt')
METSIM_WHRadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/whradjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/t2dadjbmi_coloc_summary_file.txt')
GTEx_WHRadjBMI$Gene_ID <- gsub('\\..*','',GTEx_WHRadjBMI$Gene_ID)
GTEx_T2DadjBMI$Gene_ID <- gsub('\\..*','',GTEx_T2DadjBMI$Gene_ID)
# declare functions ----------------------------------------------------------
find_significant_colocs <- function(coloc_stats){
coloc_stats <- subset(coloc_stats, PPH4 > 0.50)
column_names <- colnames(coloc_stats)
if ('Gene_ID' %in% column_names) {
coloc_stats <- subset(coloc_stats, !(Gene_ID %in% genes_not_in_discordant_loci))
}
return(coloc_stats)
}
# execute analysis ----------------------------------------------------------
genes_not_in_discordant_loci <- c('ENSG00000126861','ENSG00000126860','ENSG00000196712','EVI2A','NF1')
STARNET_T2DadjBMI <- find_significant_colocs(STARNET_T2DadjBMI)
STARNET_WHRadjBMI <- find_significant_colocs(STARNET_WHRadjBMI)
GTEx_T2DadjBMI <- find_significant_colocs(GTEx_T2DadjBMI)
GTEx_WHRadjBMI <- find_significant_colocs(GTEx_WHRadjBMI)
METSIM_WHRadjBMI <- find_significant_colocs(METSIM_WHRadjBMI)
METSIM_T2DadjBMI <- find_significant_colocs(METSIM_T2DadjBMI)
METSIM_T2DadjBMI_sQTL <- find_significant_colocs(METSIM_T2DadjBMI_sQTL)
METSIM_WHRadjBMI_sQTL <- find_significant_colocs(METSIM_WHRadjBMI_sQTL)
unique(c(GTEx_T2DadjBMI$Gene_ID,GTEx_WHRadjBMI$Gene_ID))
unique(c(GTEx_T2DadjBMI$Tissue_Name,GTEx_WHRadjBMI$Tissue_Name))
# declare functions ----------------------------------------------------------
find_significant_colocs <- function(coloc_stats){
coloc_stats <- subset(coloc_stats, PPH4 > 0.50)
column_names <- colnames(coloc_stats)
if ('Gene_ID' %in% column_names) {
coloc_stats <- subset(coloc_stats, !(Gene_ID %in% genes_not_in_discordant_loci))
}
if ('Tissue_Name' %in% column_names) {
coloc_stats$Tissue_Name <- gsub('\\..*','',coloc_stats$Tissue_Name)
}
return(coloc_stats)
}
STARNET_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/t2dadjbmi_coloc_summary_file.txt')
STARNET_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/whradjbmi_coloc_summary_file.txt')
GTEx_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/t2dadjbmi_coloc_summary_file.txt')
GTEx_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/whradjbmi_coloc_summary_file.txt')
METSIM_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/eQTL/whradjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/eQTL/t2dadjbmi_coloc_summary_file.txt')
METSIM_WHRadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/whradjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/t2dadjbmi_coloc_summary_file.txt')
# declare functions ----------------------------------------------------------
find_significant_colocs <- function(coloc_stats){
coloc_stats <- subset(coloc_stats, PPH4 > 0.50)
column_names <- colnames(coloc_stats)
if ('Gene_ID' %in% column_names) {
coloc_stats$Gene_ID <- gsub('\\..*','',coloc_stats$Gene_ID)
coloc_stats <- subset(coloc_stats, !(Gene_ID %in% genes_not_in_discordant_loci))
}
if ('Tissue_Name' %in% column_names) {
coloc_stats$Tissue_Name <- gsub('\\..*','',coloc_stats$Tissue_Name)
}
return(coloc_stats)
}
# execute analysis ----------------------------------------------------------
genes_not_in_discordant_loci <- c('ENSG00000126861','ENSG00000126860','ENSG00000196712','EVI2A','NF1')
STARNET_T2DadjBMI <- find_significant_colocs(STARNET_T2DadjBMI)
STARNET_WHRadjBMI <- find_significant_colocs(STARNET_WHRadjBMI)
GTEx_T2DadjBMI <- find_significant_colocs(GTEx_T2DadjBMI)
GTEx_WHRadjBMI <- find_significant_colocs(GTEx_WHRadjBMI)
METSIM_WHRadjBMI <- find_significant_colocs(METSIM_WHRadjBMI)
METSIM_T2DadjBMI <- find_significant_colocs(METSIM_T2DadjBMI)
METSIM_T2DadjBMI_sQTL <- find_significant_colocs(METSIM_T2DadjBMI_sQTL)
METSIM_WHRadjBMI_sQTL <- find_significant_colocs(METSIM_WHRadjBMI_sQTL)
# load libraries ----------------------------------------------------------
# load data ----------------------------------------------------------
STARNET_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/t2dadjbmi_coloc_summary_file.txt')
STARNET_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/STARNET/1e-05/whradjbmi_coloc_summary_file.txt')
GTEx_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/t2dadjbmi_coloc_summary_file.txt')
GTEx_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/GTEx/whradjbmi_coloc_summary_file.txt')
METSIM_WHRadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/eQTL/whradjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/eQTL/t2dadjbmi_coloc_summary_file.txt')
METSIM_WHRadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/whradjbmi_coloc_summary_file.txt')
METSIM_T2DadjBMI_sQTL <- read.delim('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/results/METSIM/sQTL/t2dadjbmi_coloc_summary_file.txt')
# declare functions ----------------------------------------------------------
find_significant_colocs <- function(coloc_stats){
coloc_stats <- subset(coloc_stats, PPH4 > 0.50)
column_names <- colnames(coloc_stats)
if ('Gene_ID' %in% column_names) {
coloc_stats$Gene_ID <- gsub('\\..*','',coloc_stats$Gene_ID)
coloc_stats <- subset(coloc_stats, !(Gene_ID %in% genes_not_in_discordant_loci))
}
if ('Tissue_Name' %in% column_names) {
coloc_stats$Tissue_Name <- gsub('\\..*','',coloc_stats$Tissue_Name)
}
return(coloc_stats)
}
# execute analysis ----------------------------------------------------------
genes_not_in_discordant_loci <- c('ENSG00000126861','ENSG00000126860','ENSG00000196712','EVI2A','NF1')
STARNET_T2DadjBMI <- find_significant_colocs(STARNET_T2DadjBMI)
STARNET_WHRadjBMI <- find_significant_colocs(STARNET_WHRadjBMI)
GTEx_T2DadjBMI <- find_significant_colocs(GTEx_T2DadjBMI)
GTEx_WHRadjBMI <- find_significant_colocs(GTEx_WHRadjBMI)
METSIM_WHRadjBMI <- find_significant_colocs(METSIM_WHRadjBMI)
METSIM_T2DadjBMI <- find_significant_colocs(METSIM_T2DadjBMI)
METSIM_T2DadjBMI_sQTL <- find_significant_colocs(METSIM_T2DadjBMI_sQTL)
METSIM_WHRadjBMI_sQTL <- find_significant_colocs(METSIM_WHRadjBMI_sQTL)
View(STARNET_T2DadjBMI)
View(STARNET_WHRadjBMI)
setwd('/Users/ya8eb/Documents/Research/colocalization_analysis_whradjbmi_t2dadjbmi/tactical_no_brain/results')
#### make TACTICAL figures ------------------------------------------------
Combined_classified.df <- read.delim('Combined_classified.txt')
#### map discordant genetic association signals to epigenetic annotations ------------------------------------------------
setwd('/Users/ya8eb/Documents/Research/colocalization_analysis_whradjbmi_t2dadjbmi/tactical_no_brain/formatted_data')
library(vroom)
#### map discordant genetic association signals to epigenetic annotations ------------------------------------------------
setwd('/Users/ya8eb/Documents/Research/colocalization_analysis_whradjbmi_t2dadjbmi/tactical_no_brain/formatted_data')
credible_input_corrected.df <- vroom('credible_input_corrected.txt')
discordant_snps_99 <- subset(credible_99, sign(WHRadjBMI_Z) != sign(T2DadjBMI_Z))
credible_99 <- vroom('/Users/ya8eb/Documents/Research/colocalization_analysis_whradjbmi_t2dadjbmi/credible_set/results/credible_sets/credible_99.txt')
discordant_snps_99 <- subset(credible_99, sign(WHRadjBMI_Z) != sign(T2DadjBMI_Z))
discordant_genetic_signals <- subset(credible_input_corrected.df, SNPID %in% discordant_snps_99$SNP)
View(credible_99)
