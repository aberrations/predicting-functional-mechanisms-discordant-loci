install.packages(c("bslib", "DT", "htmltools", "openssl", "stringi", "tibble"))
install.packages(c("haploR", "httpuv", "knitr", "meta", "nlme", "pkgload", "rmarkdown", "roxygen2", "vroom", "xfun"))
## load libraries
{
library(ggplot2)
library(caroline)
library(tidyverse)
}
install.packages(c("gert", "haploR", "matrixStats", "pbapply", "RCurl", "RJSONIO", "waldo", "XML"))
packages()
installed.packages()
installed.packages(getOption("max.print"))
installed.packages(getOption("max.print"))
devtools::install_github(“hadley/lazyeval”)
install.packages("devtools")
library(devtools)
install_github("jrs95/hyprcoloc", build_opts = c("--resave-data", "--no-manual"), build_vignettes = TRUE)
library(hyprcoloc)
browseVignettes("hyprcoloc")
## load packages
library(coloc)
library(hyprcoloc)
library(caroline)
library(dplyr)
library(locuscomparer)
library(ggplot2)
library(vroom)
## load data
AD_GWAS <- vroom('/Users/ya8eb/Downloads/AD_sumstats_Jansenetal_2019sept.txt')
exists('thevariable')
if(exists('thevariable')) {}
if(exists('thevariable')) {
print('lol')
}
if(!exists('thevariable')) {
print('lol')
}
## Declare functions.
# Function to create colocalization files.
make_empty_dataframe <- function(dataframe) {
empty_dataframe <- dataframe[1,]
empty_dataframe[1,] <- NA
empty_dataframe <- na.omit(empty_dataframe)
return(empty_dataframe)
}
random <- data.frame(list = c(1,2,3,4))
View(random)
## Declare functions.
# Function to create colocalization files.
make_empty_dataframe <- function(dataframe) {
empty_dataframe <- dataframe[1,]
empty_dataframe[1,] <- NA
empty_dataframe <- na.omit(empty_dataframe)
return(empty_dataframe)
}
empty_random <- make_empty_dataframe(random)
random[1,]
empty_dataframe <- random[1,]
empty_dataframe[1,] <- NA
random <- data.frame(list = c(1,2,3,4), list2 = c(5:8))
View(random)
## Declare functions.
# Function to create colocalization files.
make_empty_dataframe <- function(dataframe) {
empty_dataframe <- dataframe[1,]
empty_dataframe[1,] <- NA
empty_dataframe <- na.omit(empty_dataframe)
return(empty_dataframe)
}
empty_random <- make_empty_dataframe(random)
View(empty_random)
result<- rbind(random, empty_dataframe)
View(result)
View(result)
View(empty_random)
View(random)
View(result)
View(random)
View(empty_random)
result<- rbind(random, empty_dataframe)
View(result)
result<- rbind(result, empty_dataframe)
View(result)
result<- rbind(result, random)
result<- rbind(result, random)
result<- rbind(result, random)
result<- rbind(result, random)
result<- rbind(result, random)
result<- rbind(result, random)
result<- rbind(result, random)
result<- rbind(result, random)
result<- rbind(result, random)
result<- rbind(result, random)
result<- rbind(result, random)
result<- rbind(result, random)
result<- rbind(result, random)
result<- rbind(result, random)
result<- rbind(result, random)
result<- rbind(result, random)
result<- rbind(result, random)
result<- rbind(result, random)
result<- rbind(result, random)
result<- rbind(result, random)
result<- rbind(result, empty_random)
print(nrow(empty_random))
listexample <- c(1:10)
listexample[5:]
listexample[5:10]
listexample[5;]
listexample[5,]
listexample[5:end(listexample)]
listexample[5:length(listexample)]
## Load relevant libraries.
{
library(vroom)
library(coloc)
library(stringr)
library(caroline)
}
genes_in_discordant_loci <- vroom('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/formatted_data/genes_in_discordant_loci.txt')
View(genes_in_discordant_loci)
discordant_loci_information <- vroom('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/formatted_data/discordant_loci_information.txt')
View(discordant_loci_information)
genes_in_discordant_loci <- vroom('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/formatted_data/genes_in_discordant_loci.txt')
View(genes_in_discordant_loci)
genes_in_discordant_loci <- vroom('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/discordant_loci_annotation/formatted_data/genes_in_discordant_loci.txt')
discordant_loci_information$lead_snp_rsid[2:7]
discordant_loci_information$lead_snp_rsid[2:]
discordant_loci_information$lead_snp_rsid[2,]
install.packages(c("backports", "cli", "generics", "Rmpfr", "snow", "tzdb", "usethis", "uuid"))
## Load libraries
{
library(coloc)
library(caroline)
library(vroom)
library(stringr)
library(ggplot2)
library(locuscomparer)
}
t2d_eqtl <- vroom('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/colocalization_analysis/intermediate_results/eqtl_whr_t2d_coloc/T2DadjBMI_Adipose_eQTL_coloc_summary_statistics.txt')
t2d_eqtl <- vroom('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/colocalization_analysis/intermediate_results/eqtl_whr_t2d_coloc/WHRadjBMI_Adipose_eQTL_coloc_summary_statistics.txt')
whr_eqtl <- vroom('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/colocalization_analysis/intermediate_results/eqtl_whr_t2d_coloc/WHRadjBMI_Adipose_eQTL_coloc_summary_statistics.txt')
t2d_eqtl <- vroom('/Users/ya8eb/Documents/Research/Functional_Annotation_T2D_BFD/results/colocalization_analysis/intermediate_results/eqtl_whr_t2d_coloc/T2DadjBMI_Adipose_eQTL_coloc_summary_statistics.txt')
View(whr_eqtl)
View(t2d_eqtl)
library(vroom)
pancreas_eQTL <- vroom('/Users/ya8eb/Downloads/islet_meta.results.annotated.qvalue.postfreq.tbl.gz')
head(pancreas_eQTL)
head(pancreas_eQTL$gene_name)
THADA_eQTL <- subset(pancreas_eQTL, gene_name == 'THADA')
View(THADA_eQTL)
THADA_eQTL <- subset(pancreas_eQTL, gene_name == 'ZFP36L2')
THADA_eQTL <- subset(pancreas_eQTL, gene_name == 'THADA')
ZFP36L2_eQTL <- subset(pancreas_eQTL, gene_name == 'ZFP36L2')
1
View(ZFP36L2_eQTL)
View(THADA_eQTL)
View(ZFP36L2_eQTL)
asdlkfnaf <- vroom('/Users/ya8eb/Downloads/41467_2020_18581_MOESM8_ESM.txt')
library(vroom)
asdlkfnaf <- vroom('/Users/ya8eb/Downloads/41467_2020_18581_MOESM8_ESM.txt')
View(asdlkfnaf)
asdlkfnaf <- vroom('/Users/ya8eb/Downloads/STARNET browser (1).csv')
View(asdlkfnaf)
asdlkfnaf <- vroom('/Users/ya8eb/Downloads/41467_2020_18581_MOESM8_ESM.txt')
asdlkfnsadaf <- vroom('/Users/ya8eb/Downloads/STARNET browser (1).csv')
View(asdlkfnsadaf)
asdlkfnsadaf <- subset(asdlkfnsadaf, tissue == "LIV" | tissue == "VAF" | tissue == 'SF')
View(asdlkfnsadaf)
duplicated <- duplicated(asdlkfnsadaf$SNP)
duplicated
asdlkfnsadaf <- vroom('/Users/ya8eb/Downloads/STARNET browser (1).csv')
install.packages(c("cli", "dtplyr", "fansi", "glue", "jsonlite", "nlme", "Rcpp", "RcppArmadillo", "rpart", "testthat"))
install.packages(c("broom", "googleAuthR", "magrittr", "nloptr", "pillar", "quantreg", "RcppArmadillo", "readr", "rlang", "rpart", "yaml"))
install.packages("tidyverse")
install.packages("readr")
library(readr)
detach("package:readr", unload = TRUE)
remove.packages("readr")
install.packages("readr")
install.packages("readr")
install.packages("tidyverse")
remove.packages("tidyverse")
install.packages("tidyverse")
devtools::install_github("tidyverse/readr")
devtools::install_github("tidyverse/readr")
install.packages("readr")
install.packages("tidyverse")
install.packages(c("generics", "pillar", "tidyr"))
library(leafcutter)
install.packages("randomForest")
remove.packages("randomForest")
install.packages("randomForest")
install.packages("randomForest")
install.packages("randomForest")
warnings()
install.packages("randomForest")
install.packages("randomForest")
## load libraries
{
library(vroom)
library(caroline)
library(pheatmap)
library(leafcutter)
}
METSIM_spliceJunction_rawcounts <- vroom('METSIM_n426_adipose_spliceJunction_PSI.txt.gz')
# load data
setwd('/Users/ya8eb/Documents/Research/colocalization_analysis_whradjbmi_t2dadjbmi/correlation_analysis/raw_data')
METSIM_spliceJunction_rawcounts <- vroom('METSIM_n426_adipose_spliceJunction_PSI.txt.gz')
head(METSIM_spliceJunction_rawcounts$spliceID)
get_intron_meta(introns = head(METSIM_spliceJunction_rawcounts$spliceID))
intron_metas <- get_intron_meta(introns = METSIM_spliceJunction_rawcounts$spliceID)
exons_tables <- vroom('gencode.v19.annotation.gtf.gz')
head(exons_tables)
exons_tables <- rtracklayer::import('gencode.v19.annotation.gtf')
METSIM_spliceJunction_rawcounts <- vroom('METSIM_n426_adipose_spliceJunction_PSI.txt.gz')
exons_tables <- as.data.frame(rtracklayer::import('gencode.v19.annotation.gtf'))
intron_metas <- get_intron_meta(introns = METSIM_spliceJunction_rawcounts$spliceID)
head(exons_tables)
exons_tables <- subset(exons_tables, type == 'exon')
splice_ids <- map_clusters_to_genes(intron_meta = intron_metas, exons_table = gencode19_exons)
View(gencode19_exons)
## load libraries
{
library(vroom)
library(caroline)
library(pheatmap)
library(leafcutter)
}
# load data
setwd('/Users/ya8eb/Documents/Research/colocalization_analysis_whradjbmi_t2dadjbmi/correlation_analysis/raw_data')
METSIM_gene_rawcounts <- vroom('METSIM_n426_adipose_gene_rawCounts.txt.gz')
METSIM_phenotypes <- vroom('METSIM_pheno.csv')
METSIM_spliceJunction_rawcounts <- vroom('METSIM_n426_adipose_spliceJunction_PSI.txt.gz')
intron_metas <- get_intron_meta(introns = METSIM_spliceJunction_rawcounts$spliceID)
splice_ids <- map_clusters_to_genes(intron_meta = intron_metas, exons_table = gencode19_exons)
View(splice_ids)
PAM_ids <- subset(splice_ids, genes == 'PAM')
View(PAM_ids)
View(METSIM_spliceJunction_rawcounts)
View(intron_metas)
splice_ids <- map_clusters_to_genes(intron_meta = intron_metas, exons_table = gencode19_exons)
PAM_ids <- subset(splice_ids, genes == 'PAM')
PAM_ids
View(intron_metas)
# load data
setwd('/Users/ya8eb/Documents/Research/colocalization_analysis_whradjbmi_t2dadjbmi/correlation_analysis/raw_data')
METSIM_spliceJunction_rawcounts <- vroom('METSIM_n426_adipose_spliceJunction_PSI.txt.gz')
intron_metadata <- get_intron_meta(introns = METSIM_spliceJunction_rawcounts$spliceID)
genes_clusters <- map_clusters_to_genes(intron_meta = intron_metadata, exons_table = gencode19_exons)
View(genes_clusters)
View(intron_metadata)
PAM_intron_metadata <- subset(intron_metadata, clu %in% c('clu_43998','clu_43999','clu_44000','clu_44001'))
View(PAM_intron_metadata)
METSIM_gene_rawcounts <- vroom('METSIM_n426_adipose_gene_rawCounts.txt.gz')
head(METSIM_gene_rawcounts)
head(METSIM_gene_rawcounts$geneID)
list.files()
METSIM_gene_rawcounts <- vroom('METSIM_n426_adipose_gene_rawCounts.txt.gz')
list.files()
list.files()
# load data
setwd('/Users/ya8eb/Documents/Research/colocalization_analysis_whradjbmi_t2dadjbmi/correlation_analysis/raw_data')
METSIM_phenotypes <- vroom('METSIM_pheno.csv')
METSIM_transcript_rawcounts <- vroom('METSIM_n426_adipose_Salmon_transcript_rawCounts.txt.gz')
METSIM_gene_rawcounts <- vroom('METSIM_n426_adipose_gene_rawCounts.txt.gz')
head(METSIM_transcript_rawcounts)
1
eGenes_concordant_loci <- data.frame(gene_symbol = c('ADAMTS9',
'ADAMTS9-AS1',
'ADAMTS9-AS2'),
ensembl_id = c('ENSG00000163638.13',
'ENSG00000241158.7',
'ENSG00000241684.7'))
eGenes_discordant_loci <- data.frame(gene_symbol = c('PLPP1',
'SLC38A9',
'THADA',
'THADA-AS',
'ZFP36L2',
'LINC01126',
'PAM',
'EVI2A',
'NF1'),
ensembl_id = c('ENSG00000067113.16',
'ENSG00000177058.11',
'ENSG00000115970.18',
'ENSG00000234936.1',
'ENSG00000152518.8',
'ENSG00000279873.2',
'ENSG00000145730.21',
'ENSG00000126860.12',
'ENSG00000196712.19'))
View(head(METSIM_transcript_rawcounts))
METSIM_transcript_rawcounts$gene <- sub("\\..*","",METSIM_transcript_rawcounts$gene)
eGenes_discordant_loci$ensembl_id <- sub("\\..*","",eGenes_discordant_loci$ensembl_id)
METSIM_gene_rawcounts$geneID <- sub("\\..*","",METSIM_gene_rawcounts$geneID)
METSIM_gene_rawcounts <- subset(METSIM_gene_rawcounts, geneID %in% eGenes_discordant_loci$ensembl_id)
METSIM_transcript_rawcounts <- subset(METSIM_transcript_rawcounts, gene %in% eGenes_discordant_loci$ensembl_id)
View(METSIM_transcript_rawcounts)
unique(METSIM_transcript_rawcounts$gene)
View(METSIM_transcript_rawcounts)
View(METSIM_transcript_rawcounts)
# Keep Transcripts expressed in 50%+ of METSIM donors TPM > 0.1
METSIM_gene_rawcounts_common <- METSIM_gene_rawcounts[,-c(1)] > 100
row_sums_filtering <- rowSums(METSIM_gene_rawcounts_common)
row_sums_filtering <- data.frame(geneID = METSIM_gene_rawcounts$geneID,
METSIM_Donor_Expression = row_sums_filtering)
row_sums_filtering <- subset(row_sums_filtering, METSIM_Donor_Expression > 426/2)
METSIM_gene_rawcounts_common <- subset(METSIM_gene_rawcounts,
geneID %in% row_sums_filtering$geneID)
rm(row_sums_filtering,METSIM_gene_rawcounts)
# Keep Transcripts expressed in 50%+ of METSIM donors TPM > 0.1
METSIM_transcript_rawcounts_common <- METSIM_transcript_rawcounts[,-c(1)] > 100
row_sums_filtering <- rowSums(METSIM_transcript_rawcounts_common)
row_sums_filtering <- data.frame(geneID = METSIM_transcript_rawcounts$geneID,
METSIM_Donor_Expression = row_sums_filtering)
View(METSIM_transcript_rawcounts)
METSIM_transcript_rawcounts_common <- subset(METSIM_transcript_rawcounts,
transcript %in% row_sums_filtering$transcript)
# Keep Transcripts expressed in 50%+ of METSIM donors TPM > 0.1
METSIM_transcript_rawcounts_common <- METSIM_transcript_rawcounts[,-c(1)] > 100
row_sums_filtering <- rowSums(METSIM_transcript_rawcounts_common)
row_sums_filtering <- data.frame(transcript = METSIM_transcript_rawcounts$transcript,
METSIM_Donor_Expression = row_sums_filtering)
# Keep Transcripts expressed in 50%+ of METSIM donors TPM > 0.1
METSIM_transcript_rawcounts_common <- METSIM_transcript_rawcounts[,-c(1)] > 100
View(METSIM_transcript_rawcounts)
# Keep Transcripts expressed in 50%+ of METSIM donors TPM > 0.1
METSIM_transcript_rawcounts_common <- METSIM_transcript_rawcounts[,-c(1:4)] > 100
row_sums_filtering <- rowSums(METSIM_transcript_rawcounts_common)
row_sums_filtering <- data.frame(transcript = METSIM_transcript_rawcounts$transcript,
METSIM_Donor_Expression = row_sums_filtering)
row_sums_filtering <- subset(row_sums_filtering, METSIM_Donor_Expression > 426/2)
METSIM_transcript_rawcounts_common <- subset(METSIM_transcript_rawcounts,
transcript %in% row_sums_filtering$transcript)
rm(row_sums_filtering,METSIM_transcript_rawcounts)
# load data
{
# load data
setwd('/Users/ya8eb/Documents/Research/colocalization_analysis_whradjbmi_t2dadjbmi/correlation_analysis/raw_data')
METSIM_phenotypes <- vroom('METSIM_pheno.csv')
METSIM_transcript_rawcounts <- vroom('METSIM_n426_adipose_Salmon_transcript_rawCounts.txt.gz')
METSIM_gene_rawcounts <- vroom('METSIM_n426_adipose_gene_rawCounts.txt.gz')
# METSIM_spliceJunction_rawcounts <- vroom('METSIM_n426_adipose_spliceJunction_PSI.txt.gz')
# intron_metadata <- get_intron_meta(introns = METSIM_spliceJunction_rawcounts$spliceID)
# genes_clusters <- map_clusters_to_genes(intron_meta = intron_metadata, exons_table = gencode19_exons)
# PAM_ids <- subset(splice_ids, genes == 'PAM')
# PAM_intron_metadata <- subset(intron_metadata, clu %in% c('clu_43998','clu_43999','clu_44000','clu_44001'))
# PAM_expression <- subset(METSIM_spliceJunction_rawcounts, spliceID ==)
# setwd('/Users/ya8eb/Documents/Research/Mete_R01_Data/METSIM_data')
# METSIM_WHRadjBMI_phenotypes <- vroom('METSIM426_BMI_WHR_phenotypes.txt')
}
eGenes_concordant_loci <- data.frame(gene_symbol = c('ADAMTS9',
'ADAMTS9-AS1',
'ADAMTS9-AS2'),
ensembl_id = c('ENSG00000163638.13',
'ENSG00000241158.7',
'ENSG00000241684.7'))
eGenes_discordant_loci <- data.frame(gene_symbol = c('PLPP1',
'SLC38A9',
'THADA',
'THADA-AS',
'ZFP36L2',
'LINC01126',
'PAM',
'EVI2A',
'NF1'),
ensembl_id = c('ENSG00000067113.16',
'ENSG00000177058.11',
'ENSG00000115970.18',
'ENSG00000234936.1',
'ENSG00000152518.8',
'ENSG00000279873.2',
'ENSG00000145730.21',
'ENSG00000126860.12',
'ENSG00000196712.19'))
METSIM_transcript_rawcounts$gene <- sub("\\..*","",METSIM_transcript_rawcounts$gene)
eGenes_discordant_loci$ensembl_id <- sub("\\..*","",eGenes_discordant_loci$ensembl_id)
METSIM_gene_rawcounts$geneID <- sub("\\..*","",METSIM_gene_rawcounts$geneID)
METSIM_gene_rawcounts <- subset(METSIM_gene_rawcounts, geneID %in% eGenes_discordant_loci$ensembl_id)
METSIM_transcript_rawcounts <- subset(METSIM_transcript_rawcounts, gene %in% eGenes_discordant_loci$ensembl_id)
{
# Keep Transcripts expressed in 50%+ of METSIM donors TPM > 0.1
METSIM_gene_rawcounts_common <- METSIM_gene_rawcounts[,-c(1)] > 10
row_sums_filtering <- rowSums(METSIM_gene_rawcounts_common)
row_sums_filtering <- data.frame(geneID = METSIM_gene_rawcounts$geneID,
METSIM_Donor_Expression = row_sums_filtering)
row_sums_filtering <- subset(row_sums_filtering, METSIM_Donor_Expression > 426/2)
METSIM_gene_rawcounts_common <- subset(METSIM_gene_rawcounts,
geneID %in% row_sums_filtering$geneID)
rm(row_sums_filtering,METSIM_gene_rawcounts)
# Keep Transcripts expressed in 50%+ of METSIM donors TPM > 0.1
METSIM_transcript_rawcounts_common <- METSIM_transcript_rawcounts[,-c(1:4)] > 10
row_sums_filtering <- rowSums(METSIM_transcript_rawcounts_common)
row_sums_filtering <- data.frame(transcript = METSIM_transcript_rawcounts$transcript,
METSIM_Donor_Expression = row_sums_filtering)
row_sums_filtering <- subset(row_sums_filtering, METSIM_Donor_Expression > 426/2)
METSIM_transcript_rawcounts_common <- subset(METSIM_transcript_rawcounts,
transcript %in% row_sums_filtering$transcript)
rm(row_sums_filtering,METSIM_transcript_rawcounts)
}
View(METSIM_transcript_rawcounts_common)
View(METSIM_gene_rawcounts_common)
View(eGenes_discordant_loci)
View(METSIM_gene_rawcounts_common)
View(METSIM_gene_rawcounts_common)
expression_donors <- as.numeric(colnames(METSIM_gene_rawcounts_common[-c(1)]))
rm(expression_donors)
